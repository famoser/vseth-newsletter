{% macro render_for_language(newsletter, locale) %}
    <container id="{{ locale }}" name="{{ locale }}">
        <row>
            <columns small="12" large="12">
                <spacer size="10"></spacer>
                <h1>{{ "newsletter.title"|trans({}, "email", locale) }}</h1>
                <p>{{ newsletter.introduction(locale) }}</p>
            </columns>
        </row>
        <spacer size="20"></spacer>
        <row>
            <columns small="12" large="12">
                <ul>
                    {% set item_count = 0 %}
                    {% for entry in newsletter.entries %}
                        {% if entry.approvedAt is not null %}
                            {% set item_count = item_count + 1 %}
                            <li>
                                <a href="#{{ entry.id }}-{{ locale }}">
                                    {{ entry.header(locale) }}
                                </a>
                            </li>
                            {% if item_count % 5 == 0 and not loop.last %}
                                <spacer size="20"></spacer>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </ul>
            </columns>
        </row>
        <spacer size="20"></spacer>
    </container>
    {% for entry in newsletter.entries %}
        {% if entry.approvedAt is not null %}
            <spacer size="5"></spacer>
            <container>
                <callout id="{{ entry.id }}-{{ locale }}" name="{{ entry.id }}-{{ locale }}" class="entry">
                    <row>
                        <columns small="12">
                            <h2>{{ entry.header(locale) }}</h2>
                            <p>
                                {{ entry.description(locale) }}
                            </p>
                            <spacer size="8"></spacer>
                            {% if entry.location is not null or entry.startAt is not null %}
                                <p>
                                    <i>
                                        {{ entry|entryEventInfo("de")|nl2br }},
                                        {% if entry.link(locale) is not null %} <a
                                                href="{{ entry.link(locale) }}">{{ "newsletter.link"|trans({}, "email", locale) }}</a>
                                        {% endif %}
                                    </i>
                                </p>
                            {% endif %}
                        </columns>
                    </row>
                </callout>
            </container>
        {% endif %}
    {% endfor %}
{% endmacro %}

{% apply inky_to_html %}
    <spacer size="20"></spacer>
    <center>
        <img class="logo" src="{{ logo_src }}" alt="Logo">
    </center>
    <p class="text-center">(<a class="secondary"
                               href="#en">{{ "newsletter.english_below"|trans({}, "email", "en") }}</a>)</p>
    <spacer size="10"></spacer>
    {{ _self.render_for_language(newsletter, "de") }}
    <spacer size="20"></spacer>
    {{ _self.render_for_language(newsletter, "en") }}
    <spacer size="10"></spacer>
    <p class="text-center"><a href="https://vseth.ethz.ch">{{ "newsletter.webpage"|trans({}, "email", "en") }}</a></p>
{% endapply %}
